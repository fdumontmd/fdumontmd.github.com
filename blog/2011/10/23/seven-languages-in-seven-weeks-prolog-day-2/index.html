
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Seven Languages in Seven Weeks Prolog Day 2 - Wakatta!</title>
  <meta name="author" content="Frédéric Dumont">

  
  <meta name="description" content="The second day with Prolog is about the main data structure (the list) and the writing of rules. Lists Lists in Prolog are just the same as in Lisp: &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.wakatta.jp/blog/2011/10/23/seven-languages-in-seven-weeks-prolog-day-2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Wakatta!" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">



  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-26245052-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Wakatta!</a></h1>
  
    <h2>Like Eureka!, only cooler</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.wakatta.jp" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Seven Languages in Seven Weeks Prolog Day 2</h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-23T23:10:00+09:00" pubdate data-updated="true">Oct 23<span>rd</span>, 2011</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>The second day with Prolog is about the main data structure (the list) and the writing of rules.</p>

<!--more-->


<h3>Lists</h3>

<p>Lists in Prolog are just the same as in Lisp: either empty, or a pair with the head (a single element) and the rest of the list:</p>

<figure class='code'><figcaption><span>Lists in Prolog  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span> <span class="o">=</span> <span class="nv">L</span><span class="p">.</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nv">H</span><span class="p">|</span><span class="nv">T</span><span class="p">].</span>
</span><span class='line'>
</span><span class='line'><span class="nv">H</span> <span class="o">=</span> <span class="m">1</span>
</span><span class='line'><span class="nv">T</span> <span class="o">=</span> <span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nv">E1</span><span class="p">|[</span><span class="nv">E2</span><span class="p">|</span><span class="nv">T</span><span class="p">]].</span>
</span><span class='line'>
</span><span class='line'><span class="nv">E1</span> <span class="o">=</span> <span class="m">1</span>
</span><span class='line'><span class="nv">E2</span> <span class="o">=</span> <span class="m">2</span>
</span><span class='line'><span class="nv">T</span> <span class="o">=</span> <span class="p">[</span><span class="m">3</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nv">E1</span><span class="p">,</span> <span class="nv">E2</span><span class="p">,</span> <span class="nv">E3</span><span class="p">].</span>
</span><span class='line'>
</span><span class='line'><span class="nv">E1</span> <span class="o">=</span> <span class="m">1</span>
</span><span class='line'><span class="nv">E2</span> <span class="o">=</span> <span class="m">2</span>
</span><span class='line'><span class="nv">E3</span> <span class="o">=</span> <span class="m">3</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Rules</h3>

<p>Rules are superficially similar to the definition of functions in functional languages (especially <a href="http://www.erlang.org/">Erlang</a>), but the similarity is treacherous. In both, rules or functions can have multiple definitions, each with different patterns; in both, the pattern must match for the rules to fire or the function to be executed; but in functional languages, only the body of the first matching pattern will be executed, whereas in Prolog all the matching patterns can fire (there are ways to control that, but they are not covered in this book).</p>

<p>Another way in which they differ is that they do not return a value: whatever they return must be unified against one of the parameters. While this might appear clumsy, it has a significant benefit: rules can relate parameters in more than one direction (see the section &#8216;Using Rules in Both Directions&#8217; in the book). Consider this:</p>

<figure class='code'><figcaption><span>Rules invocation  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">length</span><span class="p">([</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">],</span> <span class="nv">L</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="m">3</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">length</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span> <span class="m">3</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span></code></pre></td></tr></table></div></figure>


<p>The first query is a typical invocation; the second ask what a list of length 3 might look like. Rules do not always support such multiple interpretations, and it is not always easy to know which does. But writing such rules is like writing functions that handle infinite data structure in Haskell: a necessary step on the way from superficial knowledge of the language to deeper understanding.</p>

<p>The second answer is a list of 3, unbound variables. Combined with other rules,</p>

<p>Sometimes the alternative interpretation is unbounded. Consider <a href="http://www.gprolog.org/manual/gprolog.html#htoc209"><code>member</code></a>:</p>

<figure class='code'><figcaption><span>member invocation  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">member</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">X</span> <span class="o">=</span> <span class="m">1</span> <span class="s-Atom">?</span> <span class="s-Atom">a</span>
</span><span class='line'>
</span><span class='line'><span class="nv">X</span> <span class="o">=</span> <span class="m">2</span>
</span><span class='line'>
</span><span class='line'><span class="nv">X</span> <span class="o">=</span> <span class="m">3</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">member</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="nv">L</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">|</span><span class="k">_</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="m">1</span><span class="p">|</span><span class="k">_</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="m">1</span><span class="p">|</span><span class="k">_</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="m">1</span><span class="p">|</span><span class="k">_</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="m">1</span><span class="p">|</span><span class="k">_</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="m">1</span><span class="p">|</span><span class="k">_</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="m">1</span><span class="p">|</span><span class="k">_</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="m">1</span><span class="p">|</span><span class="k">_</span><span class="p">]</span> <span class="s-Atom">?</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span></code></pre></td></tr></table></div></figure>


<p>The first query will match for each element (3 in total), as <code>X</code> is unconstrained. But the second query tries to find what a list that contains 1 look like; obviously there is an infinite number of such list (so I aborted the query after the 8 first answers).</p>

<p>I could constrain the list in different ways, for instance:</p>

<figure class='code'><figcaption><span>Constrained member invocation  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">length</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span> <span class="nf">member</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="nv">L</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="s-Atom">a</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="k">_</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span></code></pre></td></tr></table></div></figure>


<p>Or more interestingly, querying the sublists of length 3 of another list:</p>

<figure class='code'><figcaption><span>Sublists of length 3  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">length</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span> <span class="nf">sublist</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">]).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="s-Atom">a</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">no</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, if you have read the book already past Prolog Day 3, think about what the kind of code above could have done to reduce the list of variables.</p>

<h3>Higher-order Rules</h3>

<p>Prolog would be a very limited language without a way to build queries from individual components. Fortunately, it comes  with a number of predicates that let you do just that.</p>

<p><a href="http://www.gprolog.org/manual/gprolog.html#htoc67"><code>call</code></a> is one such predicates, and it is fairly powerful.</p>

<p>The most basic invocation just specifies the target predicate, then the arguments, each as a separate argument to <code>call</code>:</p>

<figure class='code'><figcaption><span>call invocation </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">call</span><span class="p">(</span><span class="s-Atom">length</span><span class="p">,</span> <span class="nv">L</span><span class="p">,</span> <span class="m">3</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span></code></pre></td></tr></table></div></figure>


<p>Passing the predicate as a atom via a variable is also supported:</p>

<figure class='code'><figcaption><span>Dynamic predicate invocation  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nv">P</span> <span class="o">=</span> <span class="s-Atom">length</span><span class="p">,</span> <span class="nf">call</span><span class="p">(</span><span class="nv">P</span><span class="p">,</span> <span class="nv">L</span><span class="p">,</span> <span class="m">3</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">]</span>
</span><span class='line'><span class="nv">P</span> <span class="o">=</span> <span class="s-Atom">length</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span></code></pre></td></tr></table></div></figure>


<p>The actual predicate could come from even stranger places:</p>

<figure class='code'><figcaption><span>Dynamic predicate computation  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">member</span><span class="p">(</span><span class="nv">P</span><span class="p">,</span> <span class="p">[</span><span class="s-Atom">length</span><span class="p">]),</span> <span class="nf">call</span><span class="p">(</span><span class="nv">P</span><span class="p">,</span> <span class="nv">L</span><span class="p">,</span> <span class="m">3</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">,</span><span class="k">_</span><span class="p">]</span>
</span><span class='line'><span class="nv">P</span> <span class="o">=</span> <span class="s-Atom">length</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, <code>call</code> supports a kind of currying (partial application): the first argument can specify it&#8217;s first parameters:</p>

<figure class='code'><figcaption><span>Dynamic predicate computation  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">member</span><span class="p">(</span><span class="nv">P</span><span class="p">,</span> <span class="p">[</span><span class="nf">member</span><span class="p">(</span><span class="s-Atom">x</span><span class="p">),</span> <span class="nf">member</span><span class="p">(</span><span class="s-Atom">y</span><span class="p">)]),</span> <span class="nf">length</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="nf">call</span><span class="p">(</span><span class="nv">P</span><span class="p">,</span> <span class="nv">L</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="s-Atom">x</span><span class="p">,</span><span class="k">_</span><span class="p">]</span>
</span><span class='line'><span class="nv">P</span> <span class="o">=</span> <span class="nf">member</span><span class="p">(</span><span class="s-Atom">x</span><span class="p">)</span> <span class="s-Atom">?</span> <span class="s-Atom">a</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="s-Atom">x</span><span class="p">]</span>
</span><span class='line'><span class="nv">P</span> <span class="o">=</span> <span class="nf">member</span><span class="p">(</span><span class="s-Atom">x</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="s-Atom">y</span><span class="p">,</span><span class="k">_</span><span class="p">]</span>
</span><span class='line'><span class="nv">P</span> <span class="o">=</span> <span class="nf">member</span><span class="p">(</span><span class="s-Atom">y</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">_</span><span class="p">,</span><span class="s-Atom">y</span><span class="p">]</span>
</span><span class='line'><span class="nv">P</span> <span class="o">=</span> <span class="nf">member</span><span class="p">(</span><span class="s-Atom">y</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here <code>P</code> is unified with two partially applied predicates, <code>member(x)</code> and <code>member(y)</code>. Then each is applied to a list of length 2. Note that backtracking works across <code>call</code>.</p>

<p>As a side note: a predicate followed by a list of arguments (either variables or atoms or other valid Prolog values) is called a structure. It is a kind of names tuple. In a Prolog file, it can be used to define facts. At the Prolog prompt, it can be used to run queries. But it can also be used as generic data structure, or as argument to <code>call</code> and similar functions.</p>

<h2>Exercises</h2>

<p>After the preamble above, the exercises won&#8217;t be too taxing.</p>

<h3>Hanoi Tower</h3>

<p>This was not exactly an exercise, but the implementation is really simple. It doesn&#8217;t take too long to come up with a recursive algorithm (and for those who really can&#8217;t, check the Wikipedia <a href="http://en.wikipedia.org/wiki/Tower_of_Hanoi">page</a>):</p>

<ul>
<li>to move one disk from a peg to another, just do it;</li>
<li>to move a stack of disks from one peg to a second one, first move all but the last disk to the third peg, move the last disk to the second peg, then move all the disks previously moved from third to second.</li>
</ul>


<p>A translation in Prolog is equally simple:</p>

<figure class='code'><figcaption><span>Hanoi Tower  (hanoi.pl)</span> <a href='/downloads/code/7l7w/prolog/hanoi.pl'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="nf">hanoi</span><span class="p">(</span><span class="nv">N</span><span class="p">)</span> <span class="p">:-</span> <span class="nf">move</span><span class="p">(</span><span class="nv">N</span><span class="p">,</span> <span class="s-Atom">left</span><span class="p">,</span> <span class="s-Atom">right</span><span class="p">,</span> <span class="s-Atom">center</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nf">move</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="nv">P1</span><span class="p">,</span> <span class="nv">P2</span><span class="p">,</span> <span class="k">_</span><span class="p">)</span> <span class="p">:-</span> <span class="nf">move_one</span><span class="p">(</span><span class="nv">P1</span><span class="p">,</span> <span class="nv">P2</span><span class="p">).</span>
</span><span class='line'><span class="nf">move</span><span class="p">(</span><span class="nv">N</span><span class="p">,</span> <span class="nv">P1</span><span class="p">,</span> <span class="nv">P2</span><span class="p">,</span> <span class="nv">P3</span><span class="p">)</span> <span class="p">:-</span>
</span><span class='line'>    <span class="nv">N</span> <span class="o">&gt;</span> <span class="m">1</span><span class="p">,</span> <span class="nv">N1</span> <span class="o">is</span> <span class="nv">N</span> <span class="o">-</span> <span class="m">1</span><span class="p">,</span>
</span><span class='line'>    <span class="nf">move</span><span class="p">(</span><span class="nv">N1</span><span class="p">,</span> <span class="nv">P1</span><span class="p">,</span> <span class="nv">P3</span><span class="p">,</span> <span class="nv">P2</span><span class="p">),</span>
</span><span class='line'>    <span class="nf">move</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="nv">P1</span><span class="p">,</span> <span class="nv">P2</span><span class="p">,</span> <span class="nv">P3</span><span class="p">),</span>
</span><span class='line'>    <span class="nf">move</span><span class="p">(</span><span class="nv">N1</span><span class="p">,</span> <span class="nv">P3</span><span class="p">,</span> <span class="nv">P2</span><span class="p">,</span> <span class="nv">P1</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nf">move_one</span><span class="p">(</span><span class="nv">P1</span><span class="p">,</span> <span class="nv">P2</span><span class="p">)</span> <span class="p">:-</span> <span class="nf">format</span><span class="p">(</span><span class="s2">&quot;Move disk from ~k to ~k&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nv">P1</span><span class="p">,</span> <span class="nv">P2</span><span class="p">]),</span> <span class="s-Atom">nl</span><span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>It should be easy to match the algorithm to the implementation.</p>

<figure class='code'><figcaption><span>Testing Hanoi implementation  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">hanoi</span><span class="p">(</span><span class="m">3</span><span class="p">).</span>
</span><span class='line'><span class="nv">Move</span> <span class="s-Atom">disk</span> <span class="s-Atom">from</span> <span class="s-Atom">left</span> <span class="s-Atom">to</span> <span class="s-Atom">right</span>
</span><span class='line'><span class="nv">Move</span> <span class="s-Atom">disk</span> <span class="s-Atom">from</span> <span class="s-Atom">left</span> <span class="s-Atom">to</span> <span class="s-Atom">center</span>
</span><span class='line'><span class="nv">Move</span> <span class="s-Atom">disk</span> <span class="s-Atom">from</span> <span class="s-Atom">right</span> <span class="s-Atom">to</span> <span class="s-Atom">center</span>
</span><span class='line'><span class="nv">Move</span> <span class="s-Atom">disk</span> <span class="s-Atom">from</span> <span class="s-Atom">left</span> <span class="s-Atom">to</span> <span class="s-Atom">right</span>
</span><span class='line'><span class="nv">Move</span> <span class="s-Atom">disk</span> <span class="s-Atom">from</span> <span class="s-Atom">center</span> <span class="s-Atom">to</span> <span class="s-Atom">left</span>
</span><span class='line'><span class="nv">Move</span> <span class="s-Atom">disk</span> <span class="s-Atom">from</span> <span class="s-Atom">center</span> <span class="s-Atom">to</span> <span class="s-Atom">right</span>
</span><span class='line'><span class="nv">Move</span> <span class="s-Atom">disk</span> <span class="s-Atom">from</span> <span class="s-Atom">left</span> <span class="s-Atom">to</span> <span class="s-Atom">right</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">true</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">no</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Not expressions</h3>

<p>Prolog cannot handle not expressions properly. Fundamentally, all it can say is whether a query can be proven to true. If it says no, it just means it could not be proven true, which is slightly different from being proven false.</p>

<p>Because Prolog is a Turing complete language, it could also fail to return an answer to a specific query, meaning either the query is false, or it just needs a bit more time to be proven true&#8230;</p>

<p>There are newer languages (<a href="http://coq.inria.fr/">Coq</a> for instance) that were designed as not Turing complete (which makes them interesting. Anybody can invent a Turing complete language. It takes far more work to come up with a useful language that isn&#8217;t complete), and can handle not expressions over larger logic domains.</p>

<h3>Reverse elements in a list</h3>

<p>I am using an accumulator to build the reverse. Note that in Prolog, predicates have a specific number of arguments called the predicate arity. Predicates with the same name but different arity are different predicates. In the solution below, I have two predicates: <code>my_reverse/2</code> and <code>my_reverse/3</code>.</p>

<figure class='code'><figcaption><span>my_reverse  (reverse.pl)</span> <a href='/downloads/code/7l7w/prolog/reverse.pl'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="nf">my_reverse</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span> <span class="nv">R</span><span class="p">)</span> <span class="p">:-</span> <span class="nf">compound</span><span class="p">(</span><span class="nv">R</span><span class="p">),</span> <span class="p">!,</span> <span class="nf">my_reverse</span><span class="p">(</span><span class="nv">R</span><span class="p">,</span> <span class="nv">L</span><span class="p">).</span>
</span><span class='line'><span class="nf">my_reverse</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span> <span class="nv">R</span><span class="p">)</span> <span class="p">:-</span> <span class="nf">my_reverse</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span> <span class="nv">R</span><span class="p">,</span> <span class="p">[]).</span>
</span><span class='line'><span class="nf">my_reverse</span><span class="p">([],</span> <span class="nv">A</span><span class="p">,</span> <span class="nv">A</span><span class="p">).</span>
</span><span class='line'><span class="nf">my_reverse</span><span class="p">([</span><span class="nv">H</span><span class="p">|</span><span class="nv">T</span><span class="p">],</span> <span class="nv">R</span><span class="p">,</span> <span class="nv">A</span><span class="p">)</span> <span class="p">:-</span> <span class="nf">my_reverse</span><span class="p">(</span><span class="nv">T</span><span class="p">,</span> <span class="nv">R</span><span class="p">,</span> <span class="p">[</span><span class="nv">H</span><span class="p">|</span><span class="nv">A</span><span class="p">]).</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let&#8217;s ignore the first line for a moment. <code>my_reverse/2</code> invokes <code>my_reverse/3</code>, passing an empty accumulator. <code>my_reverse/3</code> just iterates over the element of the list, adding them to the accumulator. When it runs out of element, the accumulator becomes the result.</p>

<p>First, the code works for at least the basic case:</p>

<figure class='code'><figcaption><span>my_reverse, basic case  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">my_reverse</span><span class="p">([</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">],</span> <span class="nv">R</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span></code></pre></td></tr></table></div></figure>


<p>More interestingly, the code also works when the parameters are both variables, or partially defined lists:</p>

<figure class='code'><figcaption><span>my_reverse, undefined or partially defined parameters  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">my_reverse</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span> <span class="nv">R</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="nv">A</span><span class="p">]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="nv">A</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="nv">A</span><span class="p">,</span><span class="nv">B</span><span class="p">]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="nv">B</span><span class="p">,</span><span class="nv">A</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="nv">A</span><span class="p">,</span><span class="nv">B</span><span class="p">,</span><span class="nv">C</span><span class="p">]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="nv">C</span><span class="p">,</span><span class="nv">B</span><span class="p">,</span><span class="nv">A</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="nv">A</span><span class="p">,</span><span class="nv">B</span><span class="p">,</span><span class="nv">C</span><span class="p">,</span><span class="nv">D</span><span class="p">]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="nv">D</span><span class="p">,</span><span class="nv">C</span><span class="p">,</span><span class="nv">B</span><span class="p">,</span><span class="nv">A</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="nv">A</span><span class="p">,</span><span class="nv">B</span><span class="p">,</span><span class="nv">C</span><span class="p">,</span><span class="nv">D</span><span class="p">,</span><span class="nv">E</span><span class="p">]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="nv">E</span><span class="p">,</span><span class="nv">D</span><span class="p">,</span><span class="nv">C</span><span class="p">,</span><span class="nv">B</span><span class="p">,</span><span class="nv">A</span><span class="p">]</span> <span class="s-Atom">?</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">|</span><span class="k">_</span><span class="p">],</span> <span class="nf">my_reverse</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span> <span class="nv">R</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="nv">A</span><span class="p">]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="nv">A</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="nv">A</span><span class="p">,</span><span class="nv">B</span><span class="p">]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="nv">B</span><span class="p">,</span><span class="nv">A</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="nv">A</span><span class="p">,</span><span class="nv">B</span><span class="p">,</span><span class="nv">C</span><span class="p">]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="nv">C</span><span class="p">,</span><span class="nv">B</span><span class="p">,</span><span class="nv">A</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="nv">A</span><span class="p">,</span><span class="nv">B</span><span class="p">,</span><span class="nv">C</span><span class="p">,</span><span class="nv">D</span><span class="p">]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="nv">D</span><span class="p">,</span><span class="nv">C</span><span class="p">,</span><span class="nv">B</span><span class="p">,</span><span class="nv">A</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="nv">A</span><span class="p">,</span><span class="nv">B</span><span class="p">,</span><span class="nv">C</span><span class="p">,</span><span class="nv">D</span><span class="p">,</span><span class="nv">E</span><span class="p">]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="nv">E</span><span class="p">,</span><span class="nv">D</span><span class="p">,</span><span class="nv">C</span><span class="p">,</span><span class="nv">B</span><span class="p">,</span><span class="nv">A</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">]</span> <span class="s-Atom">?</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="m">1</span> <span class="s-Atom">ms</span><span class="p">)</span> <span class="s-Atom">yes</span>
</span></code></pre></td></tr></table></div></figure>


<p>The first query just states that both lists are reverse of each other, but does not mention any content. There is an infinite number of such list, and the code dutifully return them in order; the fresh variables used as elements for the first list are indeed in reverse order in the second.</p>

<p>The second query specifies a prefix, but not the end of the first parameter. Once again, there is an infinite number of possible answers, a few of which are shown above.</p>

<p>Now back to the first line in the definition: the code checks if the second parameter is <a href="http://www.gprolog.org/manual/gprolog.html#htoc71"><code>compound</code></a>, in other word if it is at least partially defined. This is to make the following query work:</p>

<figure class='code'><figcaption><span>my_reverse, reversed parameters  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">my_reverse</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span></code></pre></td></tr></table></div></figure>


<p>Without this line, the first result would be returned, but then Prolog would hang looking for a second (non existing) result. I must admit I do not fully understand why (rules with multiple interpretations are complex to design). I also make sure this rule is the only one to match but using the cut <code>!</code> operator: once the rule has started to match, any backtracking that could have happened in this rule is <em>cut</em>. In other words, the second pattern will not match, even though it could.</p>

<p>Backtracking introduced by previous rules is still available:</p>

<figure class='code'><figcaption><span>cut and backtracking  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span> <span class="nf">member</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span> <span class="p">[[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">],</span> <span class="p">[</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">6</span><span class="p">]]),</span> <span class="nf">my_reverse</span><span class="p">(</span><span class="nv">R</span><span class="p">,</span> <span class="nv">L</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">]</span> <span class="s-Atom">?</span> <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">L</span> <span class="o">=</span> <span class="p">[</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">6</span><span class="p">]</span>
</span><span class='line'><span class="nv">R</span> <span class="o">=</span> <span class="p">[</span><span class="m">6</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">4</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="s-Atom">yes</span>
</span><span class='line'><span class="p">|</span> <span class="s-Atom">?-</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here, the <code>member</code> clause can backtrack over the two elements; the cut in <code>my_reverse</code> does not prevent it.</p>

<h3>The smallest element in a list</h3>

<p>This time the code is not fancy at all. Using arithmetic operators (such as min) tends to constraint the code in a way that prevent fancy use (as in <code>my_reverse</code> above). So <code>my_min</code> does what it needs to do as simply as possible:</p>

<figure class='code'><figcaption><span>my_min  (min.pl)</span> <a href='/downloads/code/7l7w/prolog/min.pl'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="nf">my_min</span><span class="p">([</span><span class="nv">M</span><span class="p">],</span> <span class="nv">M</span><span class="p">).</span>
</span><span class='line'><span class="nf">my_min</span><span class="p">([</span><span class="nv">H</span><span class="p">|</span><span class="nv">T</span><span class="p">],</span> <span class="nv">M</span><span class="p">)</span> <span class="p">:-</span> <span class="nf">my_min</span><span class="p">(</span><span class="nv">T</span><span class="p">,</span> <span class="nv">M1</span><span class="p">),</span> <span class="nv">M</span> <span class="o">is</span> <span class="nf">min</span><span class="p">(</span><span class="nv">H</span><span class="p">,</span> <span class="nv">M1</span><span class="p">).</span>
</span></code></pre></td></tr></table></div></figure>


<p>Either there&#8217;s only one element in the list, and this is the minimum, or the minimum of a list is the minimum between the first element of the list, and the minimum of the rest of the list.</p>

<h3>Sort the elements of a list</h3>

<p>For this exercise, I will use the insert sort. Slow but easy. Faster implementations are provided as standard predicates in decent Prologs anyway.</p>

<figure class='code'><figcaption><span>, my_sort  (sort.pl)</span> <a href='/downloads/code/7l7w/prolog/sort.pl'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="nf">my_sort</span><span class="p">([],</span> <span class="p">[]).</span>
</span><span class='line'><span class="nf">my_sort</span><span class="p">([</span><span class="nv">H</span><span class="p">|</span><span class="nv">T</span><span class="p">],</span> <span class="nv">S2</span><span class="p">)</span> <span class="p">:-</span> <span class="nf">my_sort</span><span class="p">(</span><span class="nv">T</span><span class="p">,</span> <span class="nv">S1</span><span class="p">),</span> <span class="nf">my_insert</span><span class="p">(</span><span class="nv">H</span><span class="p">,</span> <span class="nv">S1</span><span class="p">,</span> <span class="nv">S2</span><span class="p">).</span>
</span><span class='line'>
</span><span class='line'><span class="nf">my_insert</span><span class="p">(</span><span class="nv">H</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[</span><span class="nv">H</span><span class="p">]).</span>
</span><span class='line'><span class="nf">my_insert</span><span class="p">(</span><span class="nv">H</span><span class="p">,</span> <span class="p">[</span><span class="nv">S1</span><span class="p">|</span><span class="nv">S1T</span><span class="p">],</span> <span class="p">[</span><span class="nv">H</span><span class="p">|[</span><span class="nv">S1</span><span class="p">|</span><span class="nv">S1T</span><span class="p">]])</span> <span class="p">:-</span> <span class="nv">H</span> <span class="o">=&lt;</span> <span class="nv">S1</span><span class="p">.</span>
</span><span class='line'><span class="nf">my_insert</span><span class="p">(</span><span class="nv">H</span><span class="p">,</span> <span class="p">[</span><span class="nv">S1</span><span class="p">|</span><span class="nv">S1T</span><span class="p">],</span> <span class="p">[</span><span class="nv">S1</span><span class="p">|</span><span class="nv">S1T2</span><span class="p">])</span> <span class="p">:-</span> <span class="nv">H</span> <span class="o">&gt;</span> <span class="nv">S1</span><span class="p">,</span> <span class="nf">my_insert</span><span class="p">(</span><span class="nv">H</span><span class="p">,</span> <span class="nv">S1T</span><span class="p">,</span> <span class="nv">S1T2</span><span class="p">).</span>
</span></code></pre></td></tr></table></div></figure>


<p>Once again, nothing fancy: the empty list is already sorted; to sort a larger list, sort the tail of the list, then insert the head at the right position.</p>

<p>To insert an element in a sorted list, if the list is empty, then the singleton list with that element is the answer. Otherwise, compare the element to the head: if smaller, the element is prefixed as new head of the list; otherwise, insert the element in the rest of the list.</p>

<h2>Wrapping up Day 2</h2>

<p>As I mentioned <a href="/blog/2011/10/23/seven-languages-in-seven-weeks-prolog-day-1">yesterday</a>, Prolog really is different. I suspect many readers among those who had no previous exposure to this language must have been left rather confused. The problem is that Prolog introduces a lot of features (unification, pattern matching, backtracking) that are unusual in mainstream languages. Perhaps a different order in the languages (Erlang first?) would have helped assimilate some of these features before tackling backtracking.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Frédéric Dumont</span></span>

      








  


<time datetime="2011-10-23T23:10:00+09:00" pubdate data-updated="true">Oct 23<span>rd</span>, 2011</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/books/'>Books</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://blog.wakatta.jp/blog/2011/10/23/seven-languages-in-seven-weeks-prolog-day-2/" data-via="" data-counturl="http://blog.wakatta.jp/blog/2011/10/23/seven-languages-in-seven-weeks-prolog-day-2/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2011/10/23/seven-languages-in-seven-weeks-prolog-day-1/" title="Previous Post: Seven Languages in Seven Weeks Prolog Day 1">&laquo; Seven Languages in Seven Weeks Prolog Day 1</a>
      
      
        <a class="basic-alignment right" href="/blog/2011/10/24/seven-languages-in-seven-weeks-prolog-day-3/" title="next Post: Seven Languages in Seven Weeks Prolog Day 3">Seven Languages in Seven Weeks Prolog Day 3 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>About Wakatta!</h1>
  <p>
		<a href="/about">more...</a>
	</p>
</section>

<section>
	<h1>Seven Languages in Seven Weeks Series</h1>
	
		<ul>
		
			<li class="post"><a href="/blog/2011/10/11/seven-languages-in-seven-weeks/">Intro</a></li>
		
			<li class="post"><a href="/blog/2011/10/11/seven-languages-in-seven-weeks-ruby-day-1/">Ruby Day 1</a></li>
		
			<li class="post"><a href="/blog/2011/10/12/seven-languages-in-seven-weeks-ruby-day-2/">Ruby Day 2</a></li>
		
			<li class="post"><a href="/blog/2011/10/13/seven-languages-in-seven-weeks-ruby-day-3/">Ruby Day 3</a></li>
		
			<li class="post"><a href="/blog/2011/10/18/seven-languages-in-seven-weeks-io-day-1/">Io Day 1</a></li>
		
			<li class="post"><a href="/blog/2011/10/19/seven-languages-in-seven-weeks-io-day-2/">Io Day 2</a></li>
		
			<li class="post"><a href="/blog/2011/10/20/seven-languages-in-seven-weeks-io-day-3/">Io Day 3</a></li>
		
			<li class="post"><a href="/blog/2011/10/21/seven-languages-in-seven-weeks-about-io/">About Io</a></li>
		
			<li class="post"><a href="/blog/2011/10/23/seven-languages-in-seven-weeks-prolog-day-1/">Prolog Day 1</a></li>
		
			<li class="post"><a href="/blog/2011/10/23/seven-languages-in-seven-weeks-prolog-day-2/">Prolog Day 2</a></li>
		
			<li class="post"><a href="/blog/2011/10/24/seven-languages-in-seven-weeks-prolog-day-3/">Prolog Day 3</a></li>
		
			<li class="post"><a href="/blog/2011/10/28/seven-languages-in-seven-weeks-scala-day-1/">Scala Day 1</a></li>
		
			<li class="post"><a href="/blog/2011/10/29/seven-languages-in-seven-weeks-scala-day-2/">Scala Day 2</a></li>
		
			<li class="post"><a href="/blog/2011/10/30/seven-languages-in-seven-weeks-scala-day-3/">Scala Day 3</a></li>
		
			<li class="post"><a href="/blog/2011/11/04/seven-languages-in-seven-weeks-erlang-day-1/">Erlang Day 1</a></li>
		
			<li class="post"><a href="/blog/2011/11/05/seven-languages-in-seven-weeks-erlang-day-2/">Erlang Day 2</a></li>
		
			<li class="post"><a href="/blog/2011/11/06/seven-languages-in-seven-weeks-erlang-day-3/">Erlang Day 3</a></li>
		
			<li class="post"><a href="/blog/2011/11/11/seven-languages-in-seven-weeks-clojure-day-1/">Clojure Day 1</a></li>
		
			<li class="post"><a href="/blog/2011/11/12/seven-languages-in-seven-weeks-clojure-day-2/">Clojure Day 2</a></li>
		
			<li class="post"><a href="/blog/2011/11/17/seven-languages-in-seven-weeks-haskell-day-1/">Haskell Day 1</a></li>
		
			<li class="post"><a href="/blog/2011/11/18/seven-languages-in-seven-weeks-haskell-day-2/">Haskell Day 2</a></li>
		
			<li class="post"><a href="/blog/2011/11/19/seven-languages-in-seven-weeks-haskell-day-3/">Haskell Day 3</a></li>
		
			<li class="post"><a href="/blog/2011/11/21/seven-languages-in-seven-weeks-haskell-day-3-dot-5/">Haskell Day 3.5</a></li>
		
			<li class="post"><a href="/blog/2011/11/26/seven-languages-in-seven-weeks-wrap-up/">Wrap Up</a></li>
		
		</ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/02/10/psychic-modeling/">Psychic Modeling</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/05/concrete-mathematics-chapter-1-exam-problems/">Concrete Mathematics Chapter 1 Exam Problems</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/01/seven-databases-in-seven-weeks-couchdb-day-3/">Seven Databases in Seven Weeks CouchDB Day 3</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/30/seven-databases-in-seven-weeks-couchdb-day-2/">Seven Databases in Seven Weeks CouchDB Day 2</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/30/seven-databases-in-seven-weeks-couchdb-day-1/">Seven Databases in Seven Weeks CouchDB Day 1</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/fdumontmd">@fdumontmd</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'fdumontmd',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>




  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Frédéric Dumont -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<div class="tex2jax_ignore">
<script type="text/javascript">
      var disqus_shortname = 'wakatta-blog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.wakatta.jp/blog/2011/10/23/seven-languages-in-seven-weeks-prolog-day-2/';
        var disqus_url = 'http://blog.wakatta.jp/blog/2011/10/23/seven-languages-in-seven-weeks-prolog-day-2/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>
</div>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
